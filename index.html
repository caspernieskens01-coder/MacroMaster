<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Macromasters ‚Äî Recepten met macro's</title>
  <style>
    :root{--bg:#0b0c10;--card:#12131a;--muted:#a3a3a3;--text:#f5f5f5;--acc:#0BDBE1;--ok:#22c55e;--warn:#f59e0b}
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;background:linear-gradient(180deg,#0b0c10, #111218);color:var(--text)}
    header{position:sticky;top:0;z-index:10;background:rgba(11,12,16,.8);backdrop-filter:blur(8px);border-bottom:1px solid #1f2430}
    .wrap{max-width:1100px;margin:0 auto;padding:20px}
    h1{margin:0;font-weight:800;letter-spacing:.3px}
    .sub{color:var(--muted);margin-top:6px}
    .toolbar{display:grid;grid-template-columns:1fr 180px 160px;gap:10px;margin-top:14px}
    input,select{background:#0f1117;border:1px solid #242938;color:var(--text);padding:12px 14px;border-radius:12px;outline:none}
    input::placeholder{color:#80859b}
    main{max-width:1100px;margin:18px auto;padding:0 20px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
    .card{grid-column:span 4;background:var(--card);border:1px solid #1e2230;border-radius:16px;overflow:hidden;transition:transform .12s ease, box-shadow .12s ease}
    .card:hover{transform:translateY(-2px);box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .thumb{aspect-ratio:16/9;background:#0f1117;display:flex;align-items:center;justify-content:center;color:#6b7280;font-size:12px}
    .pad{padding:14px}
    .title{font-weight:700;margin:6px 0 8px}
    .meta{display:flex;gap:8px;flex-wrap:wrap}
    .pill{font-size:12px;padding:6px 8px;border-radius:999px;border:1px solid #283047;background:#0f1117}
    .kcal{color:var(--acc);border-color:#11434b}
    .macros{display:flex;gap:10px;margin-top:8px}
    .badge{font-size:12px;padding:6px 8px;border-radius:10px;background:#0f1117;border:1px solid #283047}
    .link{all:unset;cursor:pointer}
    .empty{color:var(--muted);text-align:center;padding:40px}
    .detail{max-width:900px;margin:0 auto}
    .back{display:inline-block;margin:0 0 14px 0}
    .section{margin:18px 0}
    ul{margin:8px 0 0 18px}
    .footer{color:#8b91a3;text-align:center;padding:30px 0;border-top:1px solid #1e2230;margin-top:28px}
    @media (max-width:960px){.card{grid-column:span 6}.toolbar{grid-template-columns:1fr 1fr}.hide-sm{display:none}}
    @media (max-width:640px){.card{grid-column:span 12}}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Macromasters</h1>
      <div class="sub">Recepten met kcal & macro's. Zoek, filter, open details.</div>
      <div class="toolbar">
        <input id="q" type="search" placeholder="Zoek op titel, ingredi√´nt, tag‚Ä¶ (bijv. 'kip', 'pasta')" />
        <select id="cat">
          <option value="">Alle categorie√´n</option>
          <option value="ontbijt">Ontbijt</option>
          <option value="lunch">Lunch</option>
          <option value="diner">Diner</option>
          <option value="snack">Snack</option>
        </select>
        <select id="sort">
          <option value="">Sorteer op</option>
          <option value="kcal-asc">Kcal ‚Üë</option>
          <option value="kcal-desc">Kcal ‚Üì</option>
          <option value="protein-desc">Eiwit ‚Üì</option>
          <option value="carbs-desc">Koolh. ‚Üì</option>
          <option value="fat-desc">Vetten ‚Üì</option>
        </select>
      </div>
    </div>
  </header>

  <main>
    <div id="listView" class="wrap">
      <div id="recipes" class="grid" aria-live="polite"></div>
      <div id="empty" class="empty" hidden>Geen resultaten. Pas je zoekopdracht of filters aan.</div>
    </div>

    <div id="detailView" class="wrap detail" hidden></div>
  </main>

  <div class="footer">¬© <span id="year"></span> Macromasters ‚Äî gebouwd voor snelle macro‚Äëchecks.</div>

  <!--
  üìÅ Plaats deze bestanden in de **root** van je repo (zelfde map):
  - index.html (dit bestand)
  - recipes.json  ‚Üê BELANGRIJK: exact zo genaamd, zelfde map

  üîß Voorbeeld recipes.json (plak dit in een nieuw bestand recipes.json):
  [
    {
      "id": "chicken-teriyaki-rice",
      "title": "Chicken Teriyaki Rice (suikervrij)",
      "category": "diner",
      "kcal": 620,
      "macros": {"protein": 52, "carbs": 78, "fat": 14},
      "servings": 1,
      "time": 20,
      "image": "",
      "tags": ["rijst","kip","teriyaki","high-protein"],
      "ingredients": [
        "150 g kipfilet",
        "200 g gekookte jasmijnrijst",
        "150 g broccoli",
        "15 ml sojasaus (normaal)",
        "10 ml mirin 0% suiker of water",
        "5 ml sesamolie"
      ],
      "steps": [
        "Bak kip goudbruin, voeg broccoli toe.",
        "Roer sojasaus + mirin/water + sesamolie erdoor.",
        "Serveren op rijst."
      ]
    },
    {
      "id": "skyr-bowl",
      "title": "Volle kwark bowl met fruit",
      "category": "ontbijt",
      "kcal": 480,
      "macros": {"protein": 35, "carbs": 52, "fat": 15},
      "servings": 1,
      "time": 5,
      "image": "",
      "tags": ["kwark","fruit","makkelijk"],
      "ingredients": [
        "500 g volle kwark",
        "100 g aardbeien",
        "30 g muesli"
      ],
      "steps": ["Alles in een kom, klaar."]
    }
  ]

  üß™ Test-lokaal: open index.html dubbelklik (fetch werkt ook via file:// in moderne browsers). Op GitHub Pages werkt fetch standaard zolang recipes.json in dezelfde map staat.
  -->

  <script>
    const $ = (q, el=document) => el.querySelector(q);
    const $$ = (q, el=document) => [...el.querySelectorAll(q)];

    const state = {
      all: [],
      view: 'list', // 'list' | 'detail'
      query: '',
      cat: '',
      sort: ''
    };

    function slugify(s){return s.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'')}

    async function loadData(){
      try{
        // Cache-bust tijdens testen
        const res = await fetch('./recipes.json?cb=' + Date.now());
        if(!res.ok) throw new Error('HTTP ' + res.status);
        const data = await res.json();
        if(!Array.isArray(data)) throw new Error('recipes.json moet een array zijn');
        return data.map(r => ({...r, id: r.id || slugify(r.title)}));
      }catch(err){
        console.warn('Kon recipes.json niet laden, val terug op inline data. Fout:', err.message);
        // Fallback inline (zodat de pagina werkt ook als JSON nog niet staat)
        return JSON.parse(document.getElementById('recipes-fallback').textContent);
      }
    }

    function applyFilters(list){
      let out = list;
      const q = state.query.trim().toLowerCase();
      if(q){
        out = out.filter(r => (
          (r.title||'').toLowerCase().includes(q) ||
          (r.tags||[]).join(' ').toLowerCase().includes(q) ||
          (r.ingredients||[]).join(' ').toLowerCase().includes(q)
        ));
      }
      if(state.cat){ out = out.filter(r => (r.category||'').toLowerCase() === state.cat) }
      switch(state.sort){
        case 'kcal-asc': out = out.slice().sort((a,b)=>a.kcal-b.kcal); break;
        case 'kcal-desc': out = out.slice().sort((a,b)=>b.kcal-a.kcal); break;
        case 'protein-desc': out = out.slice().sort((a,b)=> (b.macros?.protein||0) - (a.macros?.protein||0)); break;
        case 'carbs-desc': out = out.slice().sort((a,b)=> (b.macros?.carbs||0) - (a.macros?.carbs||0)); break;
        case 'fat-desc': out = out.slice().sort((a,b)=> (b.macros?.fat||0) - (a.macros?.fat||0)); break;
      }
      return out;
    }

    function renderList(list){
      const wrap = document.getElementById('recipes');
      wrap.innerHTML = '';
      if(!list.length){ document.getElementById('empty').hidden = false; return }
      document.getElementById('empty').hidden = true;
      for(const r of list){
        const el = document.createElement('article');
        el.className = 'card';
        el.innerHTML = `
          <button class="link" data-id="${r.id}" aria-label="Open recept ${r.title}">
            <div class="thumb">${r.image?`<img src="${r.image}" alt="${r.title}" style="width:100%;height:100%;object-fit:cover">`:'Geen afbeelding'}</div>
            <div class="pad">
              <div class="title">${r.title}</div>
              <div class="meta">
                ${r.category?`<span class="pill">${r.category}</span>`:''}
                <span class="pill kcal">${r.kcal} kcal</span>
                ${r.time?`<span class="pill">${r.time} min</span>`:''}
              </div>
              <div class="macros">
                <span class="badge">P ${r.macros?.protein ?? 0} g</span>
                <span class="badge">KH ${r.macros?.carbs ?? 0} g</span>
                <span class="badge">V ${r.macros?.fat ?? 0} g</span>
              </div>
            </div>
          </button>`;
        el.addEventListener('click',()=> openDetail(r.id));
        wrap.appendChild(el);
      }
    }

    function openDetail(id){
      const r = state.all.find(x => x.id === id);
      if(!r) return;
      state.view = 'detail';
      history.pushState({id}, '', `#/${id}`);
      const dv = document.getElementById('detailView');
      dv.innerHTML = `
        <a class="back link" href="#" onclick="return backToList()">‚Üê Terug</a>
        <h2 class="title">${r.title}</h2>
        <div class="meta" style="margin:8px 0 14px">
          ${r.category?`<span class=\"pill\">${r.category}</span>`:''}
          <span class="pill kcal">${r.kcal} kcal</span>
          ${r.servings?`<span class=\"pill\">${r.servings} porties</span>`:''}
          ${r.time?`<span class=\"pill\">${r.time} min</span>`:''}
        </div>
        <div class="macros">
          <span class="badge">Eiwit: ${r.macros?.protein ?? 0} g</span>
          <span class="badge">Koolhydraten: ${r.macros?.carbs ?? 0} g</span>
          <span class="badge">Vetten: ${r.macros?.fat ?? 0} g</span>
        </div>
        <div class="section">
          <h3>Ingredi√´nten</h3>
          <ul>${(r.ingredients||[]).map(i=>`<li>${i}</li>`).join('')}</ul>
        </div>
        <div class="section">
          <h3>Stappen</h3>
          <ol>${(r.steps||[]).map(s=>`<li>${s}</li>`).join('')}</ol>
        </div>
        ${r.tags?.length?`<div class="section"><h3>Tags</h3><div class="meta">${r.tags.map(t=>`<span class=\"pill\">${t}</span>`).join('')}</div></div>`:''}
      `;
      document.getElementById('listView').hidden = true;
      dv.hidden = false;
      window.scrollTo({top:0,behavior:'smooth'});
    }

    function backToList(){
      state.view = 'list';
      document.getElementById('detailView').hidden = true;
      document.getElementById('listView').hidden = false;
      history.pushState({}, '', '#/');
      return false;
    }

    function syncControls(){
      $('#q').value = state.query; $('#cat').value = state.cat; $('#sort').value = state.sort;
      renderList(applyFilters(state.all));
    }

    function attachUI(){
      $('#q').addEventListener('input', e=>{ state.query = e.target.value; syncControls() });
      $('#cat').addEventListener('change', e=>{ state.cat = e.target.value; syncControls() });
      $('#sort').addEventListener('change', e=>{ state.sort = e.target.value; syncControls() });
      window.addEventListener('popstate', ()=>{
        const hash = location.hash.replace('#/','');
        if(!hash){ backToList(); return }
        openDetail(hash);
      });
    }

    (async function init(){
      document.getElementById('year').textContent = new Date().getFullYear();
      attachUI();
      state.all = await loadData();
      syncControls();
      const hash = location.hash.replace('#/','');
      if(hash){ openDetail(hash) }
    })();
  </script>

  <!-- Fallback data zodat de site werkt v√≥√≥r recipes.json bestaat -->
  <script id="recipes-fallback" type="application/json">[
    {"id":"skyr-bowl","title":"Volle kwark bowl met fruit","category":"ontbijt","kcal":480,"macros":{"protein":35,"carbs":52,"fat":15},"servings":1,"time":5,"image":"","tags":["kwark","fruit","makkelijk"],"ingredients":["500 g volle kwark","100 g aardbeien","30 g muesli"],"steps":["Alles in een kom, klaar."]}
  ]</script>
</body>
</html>
